(this.webpackJsonppicbed=this.webpackJsonppicbed||[]).push([[3],{106:function(n,e,t){"use strict";t.r(e);var i,o,r,s,c,a,l=t(0),u=t(23),f=t.n(u),d=(t(94),t(29)),g=t(26),h=t(8),p=t(74),b=t(68),j=t(51),m=t(27),x=t.p+"static/media/logo.507159fb.svg",O=t(5),v=m.a.header(i||(i=Object(g.a)(["\n  background-color: #2f3133;\n  display: flex;\n  align-items: center;\n  padding: 10px 100px;\n  justify-content: space-between;\n  > div {\n    color: #ffffff;\n    > button,\n    a {\n      margin-left: 10px;\n      border: 1px solid #ffffff;\n      padding: 10px;\n      cursor: pointer;\n      background-color: transparent;\n    }\n  }\n  @media (max-width: 700px) {\n    padding: 10px 30px;\n  }\n"]))),U=m.a.nav(o||(o=Object(g.a)(["\n  display: flex;\n  align-items: center;\n  > a {\n    color: #ffffff;\n    margin-left: 30px;\n    &.selected {\n      border-bottom: 1px solid #ffffff;\n    }\n  }\n"]))),w=m.a.img(r||(r=Object(g.a)(["\n  height: 50px;\n"]))),I=Object(p.a)((function(){var n=Object(b.a)(),e=n.UserStore,t=n.AuthStore;return Object(O.jsxs)(v,{children:[Object(O.jsxs)(U,{children:[Object(O.jsx)(w,{src:x}),Object(O.jsx)(d.b,{to:"/",activeClassName:"selected",exact:!0,children:"\u9996\u9875"}),Object(O.jsx)(d.b,{to:"/history",activeClassName:"selected",children:"\u4e0a\u4f20\u5386\u53f2"}),Object(O.jsx)(d.b,{to:"/about",activeClassName:"selected",children:"\u5173\u4e8e"})]}),e.currentUser?Object(O.jsxs)("div",{children:[Object(O.jsxs)("span",{children:["\u7528\u6237\uff1a",e.currentUser.getUsername()]}),Object(O.jsx)("button",{onClick:function(){t.logOut(),j.a.reset()},children:"\u6ce8\u9500"})]}):Object(O.jsxs)("div",{children:[Object(O.jsx)(d.b,{to:"/signIn",children:"\u767b\u5f55"}),Object(O.jsx)(d.b,{to:"/signUp",children:"\u6ce8\u518c"})]})]})})),y=m.a.footer(s||(s=Object(g.a)(["\n  padding: 10px 100px;\n  text-align: center;\n  margin: 0 auto;\n"]))),S=function(){return Object(O.jsx)(y,{children:"--\u6211\u662f\u5e95\u7ebf--"})},P=function(){return Object(O.jsx)(O.Fragment,{children:"Loading..."})},C=Object(l.lazy)((function(){return Promise.all([t.e(0),t.e(1),t.e(7),t.e(10)]).then(t.bind(null,250))})),L=Object(l.lazy)((function(){return Promise.all([t.e(0),t.e(6),t.e(9)]).then(t.bind(null,251))})),k=Object(l.lazy)((function(){return t.e(8).then(t.bind(null,243))})),F=Object(l.lazy)((function(){return Promise.all([t.e(0),t.e(1),t.e(2),t.e(11)]).then(t.bind(null,244))})),z=Object(l.lazy)((function(){return Promise.all([t.e(0),t.e(1),t.e(2),t.e(12)]).then(t.bind(null,245))})),A=m.a.main(c||(c=Object(g.a)(["\n  flex-grow: 1;\n  padding: 10px 100px;\n"]))),N=m.a.div(a||(a=Object(g.a)(["\n  display: flex;\n  flex-direction: column;\n  min-height: 100vh;\n"])));var q=function(){return Object(O.jsxs)(N,{children:[Object(O.jsx)(I,{}),Object(O.jsx)(A,{children:Object(O.jsx)(l.Suspense,{fallback:Object(O.jsx)(P,{}),children:Object(O.jsxs)(h.c,{children:[Object(O.jsx)(h.a,{path:"/",exact:!0,component:C}),Object(O.jsx)(h.a,{path:"/history",exact:!0,component:L}),Object(O.jsx)(h.a,{path:"/about",exact:!0,component:k}),Object(O.jsx)(h.a,{path:"/signIn",exact:!0,component:F}),Object(O.jsx)(h.a,{path:"/signUp",exact:!0,component:z})]})})}),Object(O.jsx)(S,{})]})};f.a.render(Object(O.jsx)(d.a,{children:Object(O.jsx)(q,{})}),document.getElementById("root"))},24:function(n,e,t){"use strict";t.d(e,"a",(function(){return c})),t.d(e,"b",(function(){return a}));var i=t(82),o=t(25),r=t.n(o),s=t(33);r.a.init(Object(i.a)({},s.a.leancloud)),console.log("models: start....");var c={signUp:function(n,e){var t=new o.User;return t.setUsername(n),t.setPassword(e),new Promise((function(n,e){t.signUp().then((function(e){console.log("sign up success..."),n(e)}),(function(n){console.log("sign up error......"),e(n)}))}))},signIn:function(n,e){return new Promise((function(t,i){o.User.logIn(n,e).then((function(n){console.log("sign in success..."),t(n)}),(function(n){console.log("sign up error......"),i(n)}))}))},logOut:function(){o.User.logOut()},getCurrentUser:function(){return o.User.current()}},a={add:function(n,e,t){var i=new r.a.Object("Image"),o=new r.a.File(e,n);return i.set("filename",e),i.set("owner",r.a.User.current()),i.set("url",o),new Promise((function(e,o){i.save().then((function(i){console.log("\u4fdd\u5b58\u6210\u529f");var o=new FileReader;o.readAsDataURL(n),o.onload=function(){var n=o.result;if("string"===typeof n){var r=null===n||void 0===n?void 0:n.slice(n.indexOf(",")+1,n.length);console.log(r),function(n,e,t){var i=JSON.stringify({message:"".concat(t,"\uff1a").concat(n),content:e});fetch("https://solitary-union-ab10.limkk.workers.dev/upload-image?fileId=".concat(n),{body:i,method:"POST",headers:{"content-type":"application/json"}}).then((function(n){console.log(n)})).catch((function(n){console.error(n)}))}(i.id,r,t),e(i)}}}),(function(n){console.log("\u4fdd\u5b58\u5931\u8d25"),o(n)}))}))},find:function(n){var e=n.page,t=void 0===e?0:e,i=n.limit,o=void 0===i?10:i,s=new r.a.Query("Image");return s.include("owner"),s.limit(o),s.skip(t*o),s.descending("createdAt"),s.equalTo("owner",r.a.User.current()),new Promise((function(n,e){s.find().then((function(e){return n(e)})).catch((function(n){return e(n)}))}))}}},33:function(n,e,t){"use strict";e.a={imageUrl:"https://image.versionlin.xyz/",leancloud:{appId:"Ad46YKbNw2plrBhsEIeGHoqP-gzGzoHsz",appKey:"vXDbKIsxXI3B3q9DNL6dS5uk",serverURL:"https://uqbaasqm.lc-cn-n1-shared.com"}}},51:function(n,e,t){"use strict";t.d(e,"a",(function(){return a}));var i=t(3),o=t(24),r=t(61),s=t(33),c={list:[],isLoading:!1,hasMore:!0,page:0,limit:10,append:function(n){this.list=this.list.concat(n.map((function(n,e){return{id:e,fileId:n.id,filename:n.get("filename"),url:"".concat(s.a.imageUrl).concat(n.id,".png")}})))},find:function(){var n=this;this.isLoading=!0,o.b.find({page:this.page,limit:this.limit}).then((function(e){console.log(e),n.append(e),n.page++,e.length<n.limit&&(n.hasMore=!1)})).catch((function(n){r.b.error("\u52a0\u8f7d\u6570\u636e\u5931\u8d25")})).finally((function(){n.isLoading=!1}))},reset:function(){this.list=[],this.isLoading=!1,this.hasMore=!0,this.page=0}},a=Object(i.l)(c)},68:function(n,e,t){"use strict";t.d(e,"a",(function(){return j}));var i=t(0),o=t(61),r=t(3),s=t(24),c=t(33),a={currentUser:s.a.getCurrentUser(),setCurrentUser:function(){this.currentUser=s.a.getCurrentUser()}},l=Object(r.l)(a),u={filename:"",file:null,isUploading:!1,serverFile:null,setFilename:function(n){this.filename=n},setFile:function(n){this.file=n},upload:function(){var n,e=this;return this.file?(this.isUploading=!0,this.serverFile=null,s.b.add(this.file,this.filename,null===(n=l.currentUser)||void 0===n?void 0:n.getUsername()).then((function(n){return console.log(n),e.serverFile={fileId:n.id,url:"".concat(c.a.imageUrl).concat(n.id,".png"),filename:n.get("filename")},e.serverFile}),(function(n){return o.b.error("\u4e0a\u4f20\u5931\u8d25"),Promise.reject(n)})).finally((function(){return e.isUploading=!1}))):Promise.resolve()}},f=Object(r.l)(u),d={isSignIn:!1,isLoading:!1,values:{username:"",password:""},setIsSignIn:function(n){this.isSignIn=n},setUsername:function(n){this.values.username=n},setPassword:function(n){this.values.password=n},signIn:function(){var n=this;return console.log("authStore: \u767b\u5f55\u4e2d..."),this.isLoading=!0,new Promise((function(e,t){s.a.signIn(n.values.username,n.values.password).then((function(t){console.log("authStore: \u767b\u5f55\u6210\u529f",t),Object(r.o)((function(){l.setCurrentUser(),console.log("authStore:",l.currentUser),console.log("authStore: sign in runInAction"),n.isSignIn=!0,n.isLoading=!1})),e(t)})).catch((function(n){o.b.error("\u767b\u5f55\u5931\u8d25: ".concat(n.message)),t(n)}))}))},signUp:function(){var n=this;return console.log("authStore: \u6ce8\u518c\u4e2d..."),this.isLoading=!0,new Promise((function(e,t){s.a.signUp(n.values.username,n.values.password).then((function(t){console.log("authStore: \u6ce8\u518c\u6210\u529f",t),Object(r.o)((function(){l.setCurrentUser(),console.log("authStore:",l.currentUser),console.log("authStore: sign up runInAction"),n.isSignIn=!1,n.isLoading=!1})),e(t)}),(function(n){o.b.error("\u6ce8\u518c\u5931\u8d25: ".concat(n.message)),t(n)}))}))},logOut:function(){s.a.logOut(),l.setCurrentUser(),f.serverFile=null}},g=Object(r.l)(d),h=t(51),p={AuthStore:g,UserStore:l,ImageStore:f,HistoryStore:h.a},b=Object(i.createContext)(p),j=function(){return Object(i.useContext)(b)}},94:function(n,e,t){}},[[106,4,5]]]);
//# sourceMappingURL=main.a1d8c4c1.chunk.js.map